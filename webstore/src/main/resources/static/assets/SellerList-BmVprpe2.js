import{_ as S,r as u,o as A,c as a,a as t,b as B,F as f,e as p,f as h,g as s,t as r}from"./index-CyoWKuPL.js";const C={key:0,class:"loading"},$={key:1,class:"seller-table"},w=["onClick"],x={key:2,class:"modal"},I={class:"modal-content"},R={key:0,class:"loading"},D={key:1,class:"seller-table"},L={class:"modal-actions"},z={__name:"SellerList",props:{sellers:{type:Array,default:()=>[]}},emits:["view-report"],setup(k,{emit:E}){const g=k,c=u(!1),m=u(g.sellers),i=u(!1),y=u([]),v=u(!1),_=async()=>{var o,l;c.value=!0;try{const e=localStorage.getItem("token"),n=await h.get("/api/user/allsellers",{headers:{Authorization:`Bearer ${e}`}});n.data.code===200?m.value=n.data.data||[]:alert("获取销售人员失败: "+n.data.msg)}catch(e){alert("获取销售人员失败: "+(((l=(o=e.response)==null?void 0:o.data)==null?void 0:l.msg)||e.message))}finally{c.value=!1}},b=async o=>{var l,e;if(!o){alert("缺少销售人员ID");return}v.value=!0;try{const n=localStorage.getItem("token"),d=await h.get("/api/admin/seller-category-report",{params:{sellerId:o},headers:{Authorization:`Bearer ${n}`}});d.data.code===200||Array.isArray(d.data)?(y.value=d.data.data||d.data,i.value=!0):alert("获取销售报表失败: "+(d.data.msg||"未知错误"))}catch(n){alert("获取销售报表失败: "+(((e=(l=n.response)==null?void 0:l.data)==null?void 0:e.msg)||n.message))}finally{v.value=!1}};return A(()=>{g.sellers.length||_()}),(o,l)=>(s(),a("div",null,[l[5]||(l[5]=t("h2",null,"全部销售人员",-1)),c.value?(s(),a("div",C,"加载中...")):(s(),a("table",$,[l[2]||(l[2]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"用户名"),t("th",null,"账号"),t("th",null,"操作")])],-1)),t("tbody",null,[(s(!0),a(f,null,p(m.value,e=>(s(),a("tr",{key:e.id},[t("td",null,r(e.id),1),t("td",null,r(e.username),1),t("td",null,r(e.registerPhone||e.registerEmail||"-"),1),t("td",null,[t("button",{onClick:n=>b(e.id)},"查看销售报表",8,w)])]))),128))])])),i.value?(s(),a("div",x,[t("div",I,[l[4]||(l[4]=t("h3",null,"我的品类销售报表",-1)),v.value?(s(),a("div",R,"加载中...")):(s(),a("table",D,[l[3]||(l[3]=t("thead",null,[t("tr",null,[t("th",null,"商品类别"),t("th",null,"销量"),t("th",null,"销售额")])],-1)),t("tbody",null,[(s(!0),a(f,null,p(y.value,e=>(s(),a("tr",{key:e.category},[t("td",null,r(e.category),1),t("td",null,r(e.totalQuantity),1),t("td",null,r(e.totalSalesAmount),1)]))),128))])])),t("div",L,[t("button",{class:"cancel-btn",onClick:l[0]||(l[0]=e=>i.value=!1)},"关闭")])]),t("div",{class:"modal-overlay",onClick:l[1]||(l[1]=e=>i.value=!1)})])):B("",!0)]))}},N=S(z,[["__scopeId","data-v-fa491d4e"]]);export{N as default};
